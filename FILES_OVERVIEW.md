# 4p Project Files Overview

## Core Programs

### `4p` (Original)
- **Type:** Perl script
- **Purpose:** Original altitude equation generator
- **Usage:** `./4p <input_file>`
- **Method:** Simple slope blending (can overshoot)
- **Status:** Preserved for backward compatibility

### `4p_improved` ‚≠ê NEW
- **Type:** Perl script
- **Purpose:** Enhanced altitude equation generator with multiple smoothing methods
- **Usage:** `./4p_improved -m <method> [options] <input_file>`
- **Methods:**
  - `-m 0`: Original (baseline)
  - `-m 1`: Monotone (Fritsch-Carlson) - **RECOMMENDED**
  - `-m 2`: Catmull-Rom with tension
  - `-m 3`: Limited slopes (clamped)
- **Options:**
  - `-s <factor>`: Smoothing factor (default 4.0)
  - `-t <tension>`: Tension for Catmull-Rom (0.0-1.0)
  - `-h`: Help

### `4p_1eq`
- **Type:** Perl script (existing)
- **Purpose:** Single equation variant
- **Status:** Original file, not modified

---

## Helper Scripts

### `compare_methods.pl` ‚≠ê NEW
- **Type:** Perl script
- **Purpose:** Compare all smoothing methods visually
- **Usage:** `./compare_methods.pl <input_file>`
- **Output:**
  - Runs all 4 methods
  - Generates comparison plots
  - Creates `compare_all.gnuplot` script
  - Produces `comparison.png` when run with gnuplot

### `test_monotone.sh` ‚≠ê NEW
- **Type:** Bash script
- **Purpose:** Quick test of recommended monotone method
- **Usage:** `./test_monotone.sh [input_file]`
- **Default:** Uses `alt_mytrack.txt` if no file specified

### `x_kml`
- **Type:** Executable (existing)
- **Purpose:** Extract altitude data from KML files
- **Usage:** `./x_kml <file.kml> > alt_output.txt`

---

## Documentation

### `README.md` (Updated)
- **Purpose:** Main project documentation
- **Content:**
  - Project overview
  - NEW: Section on improved smoothing methods
  - Input format specification
  - Mathematical equations
  - Links to detailed guides

### `QUICK_START.md` ‚≠ê NEW
- **Purpose:** User-friendly getting started guide
- **Content:**
  - TL;DR quick commands
  - Method comparison table
  - Step-by-step usage
  - Command reference
  - Troubleshooting
- **Audience:** Users who want to get started quickly

### `SMOOTHING_METHODS.md` ‚≠ê NEW
- **Purpose:** Technical documentation of smoothing methods
- **Content:**
  - Detailed explanation of each method
  - Algorithm descriptions
  - Pros/cons comparison
  - When to use each method
  - Technical references
- **Audience:** Users who want to understand the algorithms

### `OVERSHOOT_EXPLAINED.md` ‚≠ê NEW
- **Purpose:** Visual explanation of overshoot problem
- **Content:**
  - ASCII art diagrams
  - Real-world examples
  - Visual comparisons
  - Decision trees
  - Testing methods
- **Audience:** Users who want to understand the problem visually

### `IMPROVEMENTS_SUMMARY.md` ‚≠ê NEW
- **Purpose:** Complete technical summary of improvements
- **Content:**
  - What was changed and why
  - Algorithm details
  - Performance comparison
  - Mathematical background
  - References
- **Audience:** Technical users and developers

### `FILES_OVERVIEW.md` ‚≠ê NEW (This file)
- **Purpose:** Index of all project files
- **Content:** You're reading it!

---

## Mathematical Documentation

### `maths.md` (Existing)
- **Purpose:** LaTeX-style mathematical equations
- **Content:**
  - Cubic polynomial equations
  - Derivative formulas
  - Coefficient calculations
  - Domain transformations

### `mats.tex` (Existing)
- **Purpose:** LaTeX source for mathematical documentation
- **Content:** Formal mathematical notation

### `mats.pdf` (Existing)
- **Purpose:** Compiled PDF of mathematical documentation
- **Content:** Rendered equations and formulas

---

## Input Data Files

### `alt_mytrack.txt` (Example)
- **Format:** CSV
- **Structure:** `section_id, length, trace1_alt, trace2_alt, ...`
- **Purpose:** Sample altitude data for testing

### `alt_LPL.txt` (Example)
- **Format:** CSV
- **Purpose:** Another sample altitude dataset

---

## Output Files (Generated)

### `__gtk_csv.TXT`
- **Generated by:** All 4p variants
- **Format:** CSV
- **Content:** Altitude equation coefficients for GPL track editor
- **Structure:** `section, length_tics, d, a, b, c, gradient_angle` (per trace)
- **Usage:** Import into GPL track editor

### `__do_plot_all.txt`
- **Generated by:** All 4p variants
- **Format:** Gnuplot script
- **Content:** Visualization commands for altitude curves
- **Usage:** `gnuplot __do_plot_all.txt`

### Comparison Output Files (from compare_methods.pl)
- `__do_plot_all_monotone.txt`
- `__do_plot_all_catmull.txt`
- `__do_plot_all_limited.txt`
- `__gtk_csv_monotone.TXT`
- `__gtk_csv_catmull.TXT`
- `__gtk_csv_limited.TXT`
- `compare_all.gnuplot`
- `comparison.png` (after running gnuplot)

### Debug Output Files
- `output_original.txt`
- `output_monotone.txt`
- `output_catmull.txt`
- `output_limited.txt`

---

## Plot Files (Existing)

### `do_plot.txt`
- **Purpose:** Gnuplot script template

### `plot_alt0.txt`
- **Purpose:** Plot data

### `plot_check_range.txt`
- **Purpose:** Range checking plot

---

## Build System

### `Makefile`
- **Purpose:** Automate build and processing
- **Targets:**
  - `make all`: Process KML to altitude data
  - `make clean`: Remove generated files
  - `make a`: Clean and rebuild
- **Rules:**
  - `alt_%.txt`: Extract from KML
  - `do_plot_%.txt`: Generate plot from altitude data

---

## Notes Files

### `trk_notes.txt`
- **Purpose:** Track-specific notes and documentation

---

## Directory Structure

```
4p/
‚îú‚îÄ‚îÄ Core Programs
‚îÇ   ‚îú‚îÄ‚îÄ 4p                    (original)
‚îÇ   ‚îú‚îÄ‚îÄ 4p_improved           (new, recommended)
‚îÇ   ‚îî‚îÄ‚îÄ 4p_1eq                (variant)
‚îÇ
‚îú‚îÄ‚îÄ Helper Scripts
‚îÇ   ‚îú‚îÄ‚îÄ compare_methods.pl    (new)
‚îÇ   ‚îú‚îÄ‚îÄ test_monotone.sh      (new)
‚îÇ   ‚îî‚îÄ‚îÄ x_kml                 (existing)
‚îÇ
‚îú‚îÄ‚îÄ Documentation
‚îÇ   ‚îú‚îÄ‚îÄ README.md             (updated)
‚îÇ   ‚îú‚îÄ‚îÄ QUICK_START.md        (new)
‚îÇ   ‚îú‚îÄ‚îÄ SMOOTHING_METHODS.md  (new)
‚îÇ   ‚îú‚îÄ‚îÄ OVERSHOOT_EXPLAINED.md (new)
‚îÇ   ‚îú‚îÄ‚îÄ IMPROVEMENTS_SUMMARY.md (new)
‚îÇ   ‚îî‚îÄ‚îÄ FILES_OVERVIEW.md     (new, this file)
‚îÇ
‚îú‚îÄ‚îÄ Math Documentation
‚îÇ   ‚îú‚îÄ‚îÄ maths.md
‚îÇ   ‚îú‚îÄ‚îÄ mats.tex
‚îÇ   ‚îî‚îÄ‚îÄ mats.pdf
‚îÇ
‚îú‚îÄ‚îÄ Input Data
‚îÇ   ‚îú‚îÄ‚îÄ alt_mytrack.txt
‚îÇ   ‚îî‚îÄ‚îÄ alt_LPL.txt
‚îÇ
‚îú‚îÄ‚îÄ Build System
‚îÇ   ‚îî‚îÄ‚îÄ Makefile
‚îÇ
‚îî‚îÄ‚îÄ Output (Generated)
    ‚îú‚îÄ‚îÄ __gtk_csv.TXT
    ‚îú‚îÄ‚îÄ __do_plot_all.txt
    ‚îî‚îÄ‚îÄ comparison files...
```

---

## Quick Reference

### Most Common Tasks

#### 1. Generate altitude equations (recommended method)
```bash
./4p_improved -m 1 alt_mytrack.txt
```

#### 2. Compare all methods
```bash
./compare_methods.pl alt_mytrack.txt
gnuplot compare_all.gnuplot
```

#### 3. Extract altitude from KML
```bash
./x_kml mytrack.kml > alt_mytrack.txt
```

#### 4. Process and visualize
```bash
./4p_improved -m 1 alt_mytrack.txt
gnuplot __do_plot_all.txt
```

#### 5. Use in GPL track editor
```bash
./4p_improved -m 1 alt_mytrack.txt
# Import __gtk_csv.TXT into GPL track editor
```

---

## File Modification Status

### ‚úÖ Modified
- `README.md` - Added section on new smoothing methods

### ‚≠ê New Files
- `4p_improved`
- `compare_methods.pl`
- `test_monotone.sh`
- `QUICK_START.md`
- `SMOOTHING_METHODS.md`
- `OVERSHOOT_EXPLAINED.md`
- `IMPROVEMENTS_SUMMARY.md`
- `FILES_OVERVIEW.md`

### üì¶ Unchanged (Preserved)
- `4p` (original program)
- `4p_1eq`
- `x_kml`
- `maths.md`
- `mats.tex`
- `mats.pdf`
- `Makefile`
- All input data files
- All plot files
- All notes files

---

## Getting Help

### For Quick Start
‚Üí Read `QUICK_START.md`

### For Understanding Overshoot
‚Üí Read `OVERSHOOT_EXPLAINED.md`

### For Technical Details
‚Üí Read `SMOOTHING_METHODS.md`

### For Complete Overview
‚Üí Read `IMPROVEMENTS_SUMMARY.md`

### For Command Help
```bash
./4p_improved -h
```

---

## Version History

### v2.0 (Current) - Overshoot Minimization
- Added 4 smoothing methods
- Implemented Fritsch-Carlson monotone interpolation
- Added Catmull-Rom with tension
- Added comparison tools
- Comprehensive documentation

### v1.0 (Original)
- Basic cubic spline interpolation
- Single smoothing method
- GPL track format output
